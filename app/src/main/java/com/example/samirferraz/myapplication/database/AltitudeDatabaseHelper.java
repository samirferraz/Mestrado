package com.example.samirferraz.myapplication.database;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.support.annotation.NonNull;
import android.util.Log;

import com.example.pc_samir.exemplosmatriz.model.GravityPoint;

import java.util.ArrayList;
import java.util.List;
import java.util.StringTokenizer;

import static com.example.samirferraz.myapplication.database.AltitudeDatabaseContract.LocationEntry;
import static com.example.samirferraz.myapplication.database.AltitudeDatabaseContract.SQL_CREATE_ENTRIES;
import static com.example.samirferraz.myapplication.database.AltitudeDatabaseContract.SQL_DELETE_ENTRIES;

public class AltitudeDatabaseHelper extends SQLiteOpenHelper {

    // If you change the database schema, you must increment the database version.
    public static final int DATABASE_VERSION = 1;
    public static final String DATABASE_NAME = "Locations.db";

    private static final float ALPHA = 0.001f;

    public AltitudeDatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    public void onCreate(SQLiteDatabase db) {
        db.execSQL(SQL_CREATE_ENTRIES);
        String str = "320.1000    -11.4000      -10.966686156367\n" +
                "           320.3000    -11.4000      -11.009736999286\n" +
                "           320.5000    -11.4000      -11.366798311570\n" +
                "           320.7000    -11.4000      -11.990186752146\n" +
                "           320.9000    -11.4000      -12.706519973518\n" +
                "           321.1000    -11.4000      -13.273918893552\n" +
                "           321.3000    -11.4000      -13.477114132596\n" +
                "           321.5000    -11.4000      -13.217389162326\n" +
                "           321.7000    -11.4000      -12.554636434614\n" +
                "           321.9000    -11.4000      -11.681375233680\n" +
                "           322.1000    -11.4000      -10.841843751050\n" +
                "           322.3000    -11.4000      -10.235540819827\n" +
                "           322.5000    -11.4000       -9.950026520426\n" +
                "           322.7000    -11.4000       -9.950252878092\n" +
                "           322.9000    -11.4000      -10.121678217438\n" +
                "           323.1000    -11.4000      -10.338650240414\n" +
                "           320.1000    -11.6000      -10.875372851133\n" +
                "           320.3000    -11.6000      -10.864296926050\n" +
                "           320.5000    -11.6000      -11.144371260192\n" +
                "           320.7000    -11.6000      -11.670776451166\n" +
                "           320.9000    -11.6000      -12.284623883084\n" +
                "           321.1000    -11.6000      -12.769157071535\n" +
                "           321.3000    -11.6000      -12.937607400719\n" +
                "           321.5000    -11.6000      -12.712550990412\n" +
                "           321.7000    -11.6000      -12.158978693424\n" +
                "           321.9000    -11.6000      -11.455289329594\n" +
                "           322.1000    -11.6000      -10.816815059442\n" +
                "           322.3000    -11.6000      -10.409161916391\n" +
                "           322.5000    -11.6000      -10.291682856669\n" +
                "           322.7000    -11.6000      -10.413834764249\n" +
                "           322.9000    -11.6000      -10.659335877614\n" +
                "           323.1000    -11.6000      -10.910340597634\n" +
                "           320.1000    -11.8000      -10.931062339897\n" +
                "           320.3000    -11.8000      -10.863656342786\n" +
                "           320.5000    -11.8000      -11.050401834795\n" +
                "           320.7000    -11.8000      -11.451708514468\n" +
                "           320.9000    -11.8000      -11.928374601459\n" +
                "           321.1000    -11.8000      -12.295254440250\n" +
                "           321.3000    -11.8000      -12.399901390886\n" +
                "           321.5000    -11.8000      -12.189632430276\n" +
                "           321.7000    -11.8000      -11.734759821867\n" +
                "           321.9000    -11.8000      -11.196825696867\n" +
                "           322.1000    -11.8000      -10.757779259870\n" +
                "           322.3000    -11.8000      -10.544782206329\n" +
                "           322.5000    -11.8000      -10.585848076473\n" +
                "           322.7000    -11.8000      -10.814061077163\n" +
                "           322.9000    -11.8000      -11.112766414107\n" +
                "           323.1000    -11.8000      -11.374820089850\n" +
                "           320.1000    -12.0000      -11.110510786021\n" +
                "           320.3000    -12.0000      -10.991290722371\n" +
                "           320.5000    -12.0000      -11.084117144515\n" +
                "           320.7000    -12.0000      -11.355465277071\n" +
                "           320.9000    -12.0000      -11.686891353835\n" +
                "           321.1000    -12.0000      -11.925382404393\n" +
                "           321.3000    -12.0000      -11.952345077145\n" +
                "           321.5000    -12.0000      -11.738522462694\n" +
                "           321.7000    -12.0000      -11.358077814966\n" +
                "           321.9000    -12.0000      -10.954989213917\n" +
                "           322.1000    -12.0000      -10.678583610613\n" +
                "           322.3000    -12.0000      -10.619953320922\n" +
                "           322.5000    -12.0000      -10.779270426743\n" +
                "           322.7000    -12.0000      -11.076953864261\n" +
                "           322.9000    -12.0000      -11.398943774576\n" +
                "           323.1000    -12.0000      -11.650406093458\n" +
                "           320.1000    -12.2000      -11.328523193949\n" +
                "           320.3000    -12.2000      -11.166097865290\n" +
                "           320.5000    -12.2000      -11.178376832859\n" +
                "           320.7000    -12.2000      -11.337625168997\n" +
                "           320.9000    -12.2000      -11.543722012160\n" +
                "           321.1000    -12.2000      -11.671097696104\n" +
                "           321.3000    -12.2000      -11.628965941330\n" +
                "           321.5000    -12.2000      -11.405842794841\n" +
                "           321.7000    -12.2000      -11.076499816791\n" +
                "           321.9000    -12.2000      -10.767990129703\n" +
                "           322.1000    -12.2000      -10.601790321652\n" +
                "           322.3000    -12.2000      -10.640660579685\n" +
                "           322.5000    -12.2000      -10.865448599781\n" +
                "           322.7000    -12.2000      -11.190832656577\n" +
                "           322.9000    -12.2000      -11.509005150045\n" +
                "           323.1000    -12.2000      -11.737397293001\n" +
                "           320.1000    -12.4000      -11.465617110203\n" +
                "           320.3000    -12.4000      -11.272057566494\n" +
                "           320.5000    -12.4000      -11.228117976004\n" +
                "           320.7000    -12.4000      -11.310722426971\n" +
                "           320.9000    -12.4000      -11.433464478371\n" +
                "           321.1000    -12.4000      -11.490452606283\n" +
                "           321.3000    -12.4000      -11.409443313444\n" +
                "           321.5000    -12.4000      -11.188611207084\n" +
                "           321.7000    -12.4000      -10.899111184641\n" +
                "           321.9000    -12.4000      -10.652455944588\n" +
                "           322.1000    -12.4000      -10.549159095862\n" +
                "           322.3000    -12.4000      -10.634018941173\n" +
                "           322.5000    -12.4000      -10.879205032873\n" +
                "           322.7000    -12.4000      -11.201419670413\n" +
                "           322.9000    -12.4000      -11.502069852473\n" +
                "           323.1000    -12.4000      -11.708935040884\n" +
                "           320.1000    -12.6000      -11.415571068490\n" +
                "           320.3000    -12.6000      -11.206735901309\n" +
                "           320.5000    -12.6000      -11.137545852689\n" +
                "           320.7000    -12.6000      -11.187655106126\n" +
                "           320.9000    -12.6000      -11.279183109499\n" +
                "           321.1000    -12.6000      -11.317807862347\n" +
                "           321.3000    -12.6000      -11.240445939978\n" +
                "           321.5000    -12.6000      -11.046912756454\n" +
                "           321.7000    -12.6000      -10.800797223066\n" +
                "           321.9000    -12.6000      -10.599794017813\n" +
                "           322.1000    -12.6000      -10.530521145408\n" +
                "           322.3000    -12.6000      -10.629936830209\n" +
                "           322.5000    -12.6000      -10.871303716741\n" +
                "           322.7000    -12.6000      -11.179620088297\n" +
                "           322.9000    -12.6000      -11.466640078564\n" +
                "           323.1000    -12.6000      -11.666897597590\n" +
                "           320.1000    -12.8000      -11.132547657568\n" +
                "           320.3000    -12.8000      -10.927281568569\n" +
                "           320.5000    -12.8000      -10.864381309090\n" +
                "           320.7000    -12.8000      -10.923676748819\n" +
                "           320.9000    -12.8000      -11.031582964833\n" +
                "           321.1000    -12.8000      -11.099379377524\n" +
                "           321.3000    -12.8000      -11.066361992578\n" +
                "           321.5000    -12.8000      -10.928241243961\n" +
                "           321.7000    -12.8000      -10.738389892132\n" +
                "           321.9000    -12.8000      -10.582379943307\n" +
                "           322.1000    -12.8000      -10.538632555646\n" +
                "           322.3000    -12.8000      -10.643972105457\n" +
                "           322.5000    -12.8000      -10.879586015352\n" +
                "           322.7000    -12.8000      -11.182212935144\n" +
                "           322.9000    -12.8000      -11.472984890713\n" +
                "           323.1000    -12.8000      -11.688672688824\n" +
                "           320.1000    -13.0000      -10.654882438918\n" +
                "           320.3000    -13.0000      -10.471563424295\n" +
                "           320.5000    -13.0000      -10.439519763694\n" +
                "           320.7000    -13.0000      -10.536276435147\n" +
                "           320.9000    -13.0000      -10.690587590313\n" +
                "           321.1000    -13.0000      -10.817089427854\n" +
                "           321.3000    -13.0000      -10.854703478886\n" +
                "           321.5000    -13.0000      -10.792446630087\n" +
                "           321.7000    -13.0000      -10.672256808388\n" +
                "           321.9000    -13.0000      -10.568665970308\n" +
                "           322.1000    -13.0000      -10.555208536821\n" +
                "           322.3000    -13.0000      -10.672850549960\n" +
                "           322.5000    -13.0000      -10.914020715484\n" +
                "           322.7000    -13.0000      -11.227941979089\n" +
                "           322.9000    -13.0000      -11.542872845067\n" +
                "           323.1000    -13.0000      -11.793618297889\n" +
                "           320.1000    -13.2000      -10.092245905213\n" +
                "           320.3000    -13.2000       -9.942983568652\n" +
                "           320.5000    -13.2000       -9.952008324777\n" +
                "           320.7000    -13.2000      -10.093496153976\n" +
                "           320.9000    -13.2000      -10.299814630160\n" +
                "           321.1000    -13.2000      -10.490794964589\n" +
                "           321.3000    -13.2000      -10.605995377270\n" +
                "           321.5000    -13.2000      -10.627554628683\n" +
                "           321.7000    -13.2000      -10.585190307083\n" +
                "           321.9000    -13.2000      -10.541935918615\n" +
                "           322.1000    -13.2000      -10.566822385494\n" +
                "           322.3000    -13.2000      -10.705898780361\n" +
                "           322.5000    -13.2000      -10.963453021979\n" +
                "           322.7000    -13.2000      -11.300641218035\n" +
                "           322.9000    -13.2000      -11.650967937857\n" +
                "           323.1000    -13.2000      -11.944824804866\n" +
                "           320.1000    -13.4000       -9.580792926940\n" +
                "           320.3000    -13.4000       -9.465570875950\n" +
                "           320.5000    -13.4000       -9.506999792128\n" +
                "           320.7000    -13.4000       -9.677952785979\n" +
                "           320.9000    -13.4000       -9.919310420107\n" +
                "           321.1000    -13.4000      -10.161192009225\n" +
                "           321.3000    -13.4000      -10.346886012582\n" +
                "           321.5000    -13.4000      -10.451880873040\n" +
                "           321.7000    -13.4000      -10.491579281971\n" +
                "           321.9000    -13.4000      -10.514464299557\n" +
                "           322.1000    -13.4000      -10.582401610120\n" +
                "           322.3000    -13.4000      -10.744966141168\n" +
                "           322.5000    -13.4000      -11.017812716853\n" +
                "           322.7000    -13.4000      -11.374141322260\n" +
                "           322.9000    -13.4000      -11.753026146227\n" +
                "           323.1000    -13.4000      -12.080976903111\n" +
                "           320.1000    -13.6000       -9.227637524457\n" +
                "           320.3000    -13.6000       -9.131596188782\n" +
                "           320.5000    -13.6000       -9.178709629264\n" +
                "           320.7000    -13.6000       -9.346826052577\n" +
                "           320.9000    -13.6000       -9.593444529116\n" +
                "           321.1000    -13.6000       -9.865653120271\n" +
                "           321.3000    -13.6000      -10.113360080111\n" +
                "           321.5000    -13.6000      -10.303840038747\n" +
                "           321.7000    -13.6000      -10.433216672788\n" +
                "           321.9000    -13.6000      -10.529157129388\n" +
                "           322.1000    -13.6000      -10.640993278690\n" +
                "           322.3000    -13.6000      -10.818861968628\n" +
                "           322.5000    -13.6000      -11.089689994521\n" +
                "           322.7000    -13.6000      -11.441029982757\n" +
                "           322.9000    -13.6000      -11.821250428822\n" +
                "           323.1000    -13.6000      -12.157060922207\n" +
                "           320.1000    -13.8000       -9.071822375179\n" +
                "           320.3000    -13.8000       -8.968007301930\n" +
                "           320.5000    -13.8000       -8.982927307788\n" +
                "           320.7000    -13.8000       -9.109693145086\n" +
                "           320.9000    -13.8000       -9.332360005863\n" +
                "           321.1000    -13.8000       -9.621306917120\n" +
                "           321.3000    -13.8000       -9.933917709958\n" +
                "           321.5000    -13.8000      -10.224721646888\n" +
                "           321.7000    -13.8000      -10.462428752122\n" +
                "           321.9000    -13.8000      -10.644876773869\n" +
                "           322.1000    -13.8000      -10.801686115123\n" +
                "           322.3000    -13.8000      -10.980122457891\n" +
                "           322.5000    -13.8000      -11.219360785651\n" +
                "           322.7000    -13.8000      -11.526082398378\n" +
                "           322.9000    -13.8000      -11.864953915182\n" +
                "           323.1000    -13.8000      -12.170108728093\n" +
                "           320.1000    -14.0000       -9.079994463156\n" +
                "           320.3000    -14.0000       -8.937534132287\n" +
                "           320.5000    -14.0000       -8.882341932478\n" +
                "           320.7000    -14.0000       -8.935093468685\n" +
                "           320.9000    -14.0000       -9.115993805815\n" +
                "           321.1000    -14.0000       -9.423074793011\n" +
                "           321.3000    -14.0000       -9.819528218047\n" +
                "           321.5000    -14.0000      -10.240382629597\n" +
                "           321.7000    -14.0000      -10.617279014450\n" +
                "           321.9000    -14.0000      -10.908379864808\n" +
                "           322.1000    -14.0000      -11.116086853181\n" +
                "           322.3000    -14.0000      -11.281428883058\n" +
                "           322.5000    -14.0000      -11.457327748405\n" +
                "           322.7000    -14.0000      -11.675446540269\n" +
                "           322.9000    -14.0000      -11.925310482197\n" +
                "           323.1000    -14.0000      -12.157355154409\n" +
                "           320.1000    -14.2000       -9.175989662383\n" +
                "           320.3000    -14.2000       -8.970966976608\n" +
                "           320.5000    -14.2000       -8.819079195400\n" +
                "           320.7000    -14.2000       -8.779476649352\n" +
                "           320.9000    -14.2000       -8.915298592077\n" +
                "           321.1000    -14.2000       -9.253865790068\n" +
                "           321.3000    -14.2000       -9.761158435801\n" +
                "           321.5000    -14.2000      -10.346467212032\n" +
                "           321.7000    -14.2000      -10.896649402943\n" +
                "           321.9000    -14.2000      -11.322635021510\n" +
                "           322.1000    -14.2000      -11.593620687105\n" +
                "           322.3000    -14.2000      -11.741170018990\n" +
                "           322.5000    -14.2000      -11.832317801882\n" +
                "           322.7000    -14.2000      -11.927844057979\n" +
                "           322.9000    -14.2000      -12.049218291207\n" +
                "           323.1000    -14.2000      -12.171361325494\n" +
                "           320.1000    -14.4000       -9.285361833985\n" +
                "           320.3000    -14.4000       -9.010039563425\n" +
                "           320.5000    -14.4000       -8.753498570725\n" +
                "           320.7000    -14.4000       -8.619144739422\n" +
                "           320.9000    -14.4000       -8.715008449637\n" +
                "           321.1000    -14.4000       -9.096854802218\n" +
                "           321.3000    -14.4000       -9.731477118046\n" +
                "           321.5000    -14.4000      -10.500545695948\n" +
                "           321.7000    -14.4000      -11.244552963225\n" +
                "           321.9000    -14.4000      -11.825338462712\n" +
                "           322.1000    -14.4000      -12.176179842245\n" +
                "           322.3000    -14.4000      -12.315790593472\n" +
                "           322.5000    -14.4000      -12.322406254780\n" +
                "           322.7000    -14.4000      -12.285039270924\n" +
                "           322.9000    -14.4000      -12.259245281946\n" +
                "           323.1000    -14.4000      -12.249266610510" +
                "321.1000    -12.4000      -11.490452606283\n" +
                "           321.2000    -12.4000      -11.469182313321\n" +
                "           321.3000    -12.4000      -11.409443313444\n" +
                "           321.4000    -12.4000      -11.313533714437\n" +
                "           321.5000    -12.4000      -11.188611207084\n" +
                "           321.6000    -12.4000      -11.045851537658\n" +
                "           321.7000    -12.4000      -10.899111184641\n" +
                "           321.8000    -12.4000      -10.763268289888\n" +
                "           321.9000    -12.4000      -10.652455944588\n" +
                "           322.0000    -12.4000      -10.578413087458\n" +
                "           322.1000    -12.4000      -10.549159095862\n" +
                "           321.1000    -12.5000      -11.407142487027\n" +
                "           321.2000    -12.5000      -11.382278585136\n" +
                "           321.3000    -12.5000      -11.322408149108\n" +
                "           321.4000    -12.5000      -11.229894917493\n" +
                "           321.5000    -12.5000      -11.111624083115\n" +
                "           321.6000    -12.5000      -10.978183717776\n" +
                "           321.7000    -12.5000      -10.842590748024\n" +
                "           321.8000    -12.5000      -10.718727257239\n" +
                "           321.9000    -12.5000      -10.619688307365\n" +
                "           322.0000    -12.5000      -10.556250945458\n" +
                "           322.1000    -12.5000      -10.535654530021\n" +
                "           321.1000    -12.6000      -11.317807862347\n" +
                "           321.2000    -12.6000      -11.295288880816\n" +
                "           321.3000    -12.6000      -11.240445939978\n" +
                "           321.4000    -12.6000      -11.155499113725\n" +
                "           321.5000    -12.6000      -11.046912756454\n" +
                "           321.6000    -12.6000      -10.924615231294\n" +
                "           321.7000    -12.6000      -10.800797223066\n" +
                "           321.8000    -12.6000      -10.688444671905\n" +
                "           321.9000    -12.6000      -10.599794017813\n" +
                "           322.0000    -12.6000      -10.544904224035\n" +
                "           322.1000    -12.6000      -10.530521145408\n" +
                "           321.1000    -12.7000      -11.216423007075\n" +
                "           321.2000    -12.7000      -11.201759628600\n" +
                "           321.3000    -12.7000      -11.156817438157\n" +
                "           321.4000    -12.7000      -11.083504179638\n" +
                "           321.5000    -12.7000      -10.987745516439\n" +
                "           321.6000    -12.7000      -10.878756372250\n" +
                "           321.7000    -12.7000      -10.767919457481\n" +
                "           321.8000    -12.7000      -10.667415841861\n" +
                "           321.9000    -12.7000      -10.588781134609\n" +
                "           322.0000    -12.7000      -10.541566857413\n" +
                "           322.1000    -12.7000      -10.532269263069\n" +
                "           321.1000    -12.8000      -11.099379377524\n" +
                "           321.2000    -12.8000      -11.097223938534\n" +
                "           321.3000    -12.8000      -11.066361992578\n" +
                "           321.4000    -12.8000      -11.008266929437\n" +
                "           321.5000    -12.8000      -10.928241243961\n" +
                "           321.6000    -12.8000      -10.834750680614\n" +
                "           321.7000    -12.8000      -10.738389892132\n" +
                "           321.8000    -12.8000      -10.650611878190\n" +
                "           321.9000    -12.8000      -10.582379943307\n" +
                "           322.0000    -12.8000      -10.542907049347\n" +
                "           322.1000    -12.8000      -10.538632555646\n" +
                "           321.1000    -12.9000      -10.965736529347\n" +
                "           321.2000    -12.9000      -10.979563291087\n" +
                "           321.3000    -12.9000      -10.965961555645\n" +
                "           321.4000    -12.9000      -10.925894345344\n" +
                "           321.5000    -12.9000      -10.863987180184\n" +
                "           321.6000    -12.9000      -10.787934406422\n" +
                "           321.7000    -12.9000      -10.707558417582\n" +
                "           321.8000    -12.9000      -10.633640010528\n" +
                "           321.9000    -12.9000      -10.576662991414\n" +
                "           322.0000    -12.9000      -10.545623172589\n" +
                "           322.1000    -12.9000      -10.547040279909\n" +
                "           321.1000    -13.0000      -10.817089427854\n" +
                "           321.2000    -13.0000      -10.849025758709\n" +
                "           321.3000    -13.0000      -10.854703478886\n" +
                "           321.4000    -13.0000      -10.834538030351\n" +
                "           321.5000    -13.0000      -10.792446630087\n" +
                "           321.6000    -13.0000      -10.735335004992\n" +
                "           321.7000    -13.0000      -10.672256808388\n" +
                "           321.8000    -13.0000      -10.613348463257\n" +
                "           321.9000    -13.0000      -10.568665970308\n" +
                "           322.0000    -13.0000      -10.547058821364\n" +
                "           322.1000    -13.0000      -10.555208536821\n" +
                "           321.1000    -13.1000      -10.657101111934\n" +
                "           321.2000    -13.1000      -10.707931778715\n" +
                "           321.3000    -13.1000      -10.733754534731\n" +
                "           321.4000    -13.1000      -10.734425919460\n" +
                "           321.5000    -13.1000      -10.713133175230\n" +
                "           321.6000    -13.1000      -10.675969364827\n" +
                "           321.7000    -13.1000      -10.631200653112\n" +
                "           321.8000    -13.1000      -10.588311440383\n" +
                "           321.9000    -13.1000      -10.556936171925\n" +
                "           322.0000    -13.1000      -10.545797425785\n" +
                "           322.1000    -13.1000      -10.561766931871\n" +
                "           321.1000    -13.2000      -10.490794964589\n" +
                "           321.2000    -13.2000      -10.560139699894\n" +
                "           321.3000    -13.2000      -10.605995377270\n" +
                "           321.4000    -13.2000      -10.627657230076\n" +
                "           321.5000    -13.2000      -10.627554628683\n" +
                "           321.6000    -13.2000      -10.610923353219\n" +
                "           321.7000    -13.2000      -10.585190307083\n" +
                "           321.8000    -13.2000      -10.559137621470\n" +
                "           321.9000    -13.2000      -10.541935918615\n" +
                "           322.0000    -13.2000      -10.542149977417\n" +
                "           322.1000    -13.2000      -10.566822385494\n" +
                "           321.1000    -13.3000      -10.323730067040\n" +
                "           321.2000    -13.3000      -10.410371182067\n" +
                "           321.3000    -13.3000      -10.475491079847\n" +
                "           321.4000    -13.3000      -10.517811407782\n" +
                "           321.5000    -13.3000      -10.538952729965\n" +
                "           321.6000    -13.3000      -10.543214535832\n" +
                "           321.7000    -13.3000      -10.537089601544\n" +
                "           321.8000    -13.3000      -10.528559096296\n" +
                "           321.9000    -13.3000      -10.526237593635\n" +
                "           322.0000    -13.3000      -10.538453784245\n" +
                "           322.1000    -13.3000      -10.572360886492\n" +
                "           321.1000    -13.4000      -10.161192009225\n" +
                "           321.2000    -13.4000      -10.263507180926\n" +
                "           321.3000    -13.4000      -10.346886012582\n" +
                "           321.4000    -13.4000      -10.409436404617\n" +
                "           321.5000    -13.4000      -10.451880873040\n" +
                "           321.6000    -13.4000      -10.477457494613\n" +
                "           321.7000    -13.4000      -10.491579281971\n" +
                "           321.8000    -13.4000      -10.501275865396\n" +
                "           321.9000    -13.4000      -10.514464299557\n" +
                "           322.0000    -13.4000      -10.539116025579\n" +
                "           322.1000    -13.4000      -10.582401610120";
        addLocations(str, db);
    }

    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // This database is only a cache for online data, so its upgrade policy is
        // to simply to discard the data and start over
        db.execSQL(SQL_DELETE_ENTRIES);
        onCreate(db);
    }

    public void onDowngrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        onUpgrade(db, oldVersion, newVersion);
    }

    public void addLocation(float lat, float lng, float alt) {
        SQLiteDatabase database = getWritableDatabase();
        database.beginTransaction();
        try {
            addLocation(lat, lng, alt, database);
            database.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            database.endTransaction();
        }

    }

    private void addLocation(float lat, float lng, float alt, SQLiteDatabase database) {
        ContentValues values = new ContentValues();
        values.put(LocationEntry.COLUMN_NAME_LATITUDE, lat);
        values.put(LocationEntry.COLUMN_NAME_LONGITUDE, lng >= 180 ? lng - 360 : lng);
        values.put(LocationEntry.COLUMN_NAME_ALTITUDE, alt);

        database.insert(LocationEntry.TABLE_NAME, null, values);
    }

    public String readLocations() {
        SQLiteDatabase db = getReadableDatabase();

        String[] projection = {
                LocationEntry._ID,
                LocationEntry.COLUMN_NAME_LATITUDE,
                LocationEntry.COLUMN_NAME_LONGITUDE,
                LocationEntry.COLUMN_NAME_ALTITUDE
        };

//        String selection = LocationEntry.COLUMN_NAME_TITLE + " = ?";
//        String[] selectionArgs = { "My Title" };

        Cursor c = db.query(
                LocationEntry.TABLE_NAME,                     // The table to query
                projection,                               // The columns to return
//                selection,                                // The columns for the WHERE clause
                null,
//                selectionArgs,                            // The values for the WHERE clause
                null,
                null,                                     // don't group the rows
                null,                                     // don't filter by row groups
                null  // The sort order
        );

        Log.d("DBHELPER", " -------------------------- ");

        return getCursorString(c);
    }

    @NonNull
    private String getCursorString(Cursor c) {
        StringBuffer sb = new StringBuffer();
        while (c.moveToNext()) {
            sb.append("\n");
            sb.append(String.format("ID: %1$d, Latitude: %2$.3f Long: %3$.3f Altitude: %4$.3f ", c.getLong(0), c.getFloat(1), c.getFloat(2), c.getFloat(3)));
        }

        c.close();

        return sb.toString();
    }

    private void addLocations(String locations, SQLiteDatabase database) {
        String[] lines = locations.split("\n");
        database.beginTransaction();
        try {
            for (String line : lines) {
                StringTokenizer tokens = new StringTokenizer(line, " ");
                if (tokens.countTokens() == 3) {
                    Float lng = Float.valueOf(tokens.nextToken());
                    Float lat = Float.valueOf(tokens.nextToken());
                    Float alt = Float.valueOf(tokens.nextToken());
                    addLocation(lat, lng, alt, database);
                }
            }
            database.setTransactionSuccessful();
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            database.endTransaction();
        }
    }

    public float getAltitude(float lat, float lng) {
        Cursor c = getAltitudePoints(lat, lng);

        Log.d("DBHELPER", " -------------------------- ");

        float totalAltitude = 0f;
        try {
            if (c.getCount() == 4) {
                while (c.moveToNext()) {
                    Log.d("DBHELPER", String.format("ID: %1$d, Latitude: %2$.3f Long: %3$.3f Altitude: %4$.3f ", c.getLong(0), c.getFloat(1), c.getFloat(2), c.getFloat(3)));
                    totalAltitude += c.getFloat(3);
                }
            }
        } catch (Exception e) {
            totalAltitude = 0f;
        } finally {
            c.close();
        }

        return totalAltitude / 4;
    }

    public String getPrintableAltitudePoints(float lat, float lng) {
        Cursor c = getAltitudePoints(lat, lng);
        return getCursorString(c);
    }

    private Cursor getAltitudePoints(float lat, float lng) {
        SQLiteDatabase db = getReadableDatabase();

        String[] projection = {
                LocationEntry._ID,
                LocationEntry.COLUMN_NAME_LATITUDE,
                LocationEntry.COLUMN_NAME_LONGITUDE,
                LocationEntry.COLUMN_NAME_ALTITUDE
        };

        String selection = LocationEntry.COLUMN_NAME_LATITUDE + " > ? AND " +
                LocationEntry.COLUMN_NAME_LATITUDE + " < ? AND " +
                LocationEntry.COLUMN_NAME_LONGITUDE + " > ? AND " +
                LocationEntry.COLUMN_NAME_LONGITUDE + " < ?";
        String[] selectionArgs = {
                String.valueOf(lat - ALPHA),
                String.valueOf(lat + ALPHA),
                String.valueOf(lng - ALPHA),
                String.valueOf(lng + ALPHA)
        };

        return db.query(
                LocationEntry.TABLE_NAME,                     // The table to query
                projection,                               // The columns to return
                selection,                                // The columns for the WHERE clause
                selectionArgs,                            // The values for the WHERE clause
                null,                                     // don't group the rows
                null,                                     // don't filter by row groups
                null  // The sort order
        );
    }

    public List<GravityPoint> getAllPoints() {
        SQLiteDatabase db = getReadableDatabase();

        String[] projection = {
                LocationEntry._ID,
                LocationEntry.COLUMN_NAME_LATITUDE,
                LocationEntry.COLUMN_NAME_LONGITUDE,
                LocationEntry.COLUMN_NAME_ALTITUDE
        };

        Cursor c = db.query(
                LocationEntry.TABLE_NAME,                     // The table to query
                projection,                               // The columns to return
                null,
                null,
                null,                                     // don't group the rows
                null,                                     // don't filter by row groups
                null  // The sort order
        );

        ArrayList<GravityPoint> points = new ArrayList<GravityPoint>();
        while (c.moveToNext()) {
            points.add(new GravityPoint(c.getFloat(1), c.getFloat(2), c.getFloat(3)));
        }

        return points;
    }
}